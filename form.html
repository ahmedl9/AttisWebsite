<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">

    <!--====== Title ======-->
    <title>Attis Debt Form</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--====== Favicon Icon ======-->
    <link rel="shortcut icon" href="assets/images/favicon.png" type="image/png">

    <!--====== Magnific Popup CSS ======-->
    <link rel="stylesheet" href="assets/css/magnific-popup.css">

    <!--====== Slick CSS ======-->
    <link rel="stylesheet" href="assets/css/slick.css">

    <!--====== Line Icons CSS ======-->
    <link rel="stylesheet" href="assets/css/LineIcons.css">

    <!--====== Bootstrap CSS ======-->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <!--====== Default CSS ======-->
    <link rel="stylesheet" href="assets/css/default.css">

    <!--====== Style CSS ======-->
    <link rel="stylesheet" href="assets/css/style.css">

</head>
<body>

  <section class="navbar-area">
      <div class="container">
          <div class="row">
              <div class="col-lg-12">
                  <nav class="navbar navbar-expand-lg">

                      <a class="navbar-brand" href="#">
                        <h1 class="title" style="color:white;">Attis</h1>
                      </a>

                      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTwo" aria-controls="navbarTwo" aria-expanded="false" aria-label="Toggle navigation">
                          <span class="toggler-icon"></span>
                          <span class="toggler-icon"></span>
                          <span class="toggler-icon"></span>
                      </button>

                      <div class="collapse navbar-collapse sub-menu-bar" id="navbarTwo">
                          <ul class="navbar-nav m-auto">
                              <li class="nav-item"><a class="page-scroll" href="index.html">home</a></li>
                              <li class="nav-item"><a class="page-scroll" href="index.html#services">Services</a></li>
                              <li class="nav-item"><a class="page-scroll" href="index.html#contact">Contact</a></li>
                              <li class="nav-item active"><a class="page-scroll" href="form.html">Waitlist</a></li>
                          </ul>
                      </div>

                  </nav> <!-- navbar -->
              </div>
          </div> <!-- row -->
      </div> <!-- container -->
  </section>

  <section id="home" class="slider_area">
      <div id="carouselThree" class="carousel slide" data-ride="carousel">
          <ol>
              <li data-target="#carouselThree" data-slide-to="0" class="active"></li>
          </ol>
          <div class="carousel-inner">
              <div class="carousel-item active">
                  <div class="container">
                      <div class="row">
                          <br>
                          <br>
                          <br>
                          <br>
                      </div> <!-- row -->
                  </div> <!-- container -->
              </div> <!-- carousel-item -->
        </div>
      </div>
  </section>


  <section id="services" class="features-area">
    <div class="outer-padding">
      <div class="wrapper">
              <div class="content" id="login" style="display: block;">
                  <h1 class="title" style="color:black;">Join Our Waitlist!</h1>
                  <div class="form" method="post" action="http://localhost:3000/api/users">
                      <form onsubmit="return false;" _lpchecked="1">
                          <div>
                              <input id="first_name" class="form-input login first_name" placeholder="First Name">
                          </div>
                          <div>
                              <input id="last_name" class="form-input login last_name" placeholder="Last Name">
                          </div>

                          <div>
                              <input id="email" class="form-input login email" placeholder="Email">
                          </div>
                          <button id="btn-submit" class="form-button login colored" type="submit">Submit
                          </button>
                      </form>
                  </div>
                      <script>
                        const form = {
                            first_name: document.getElementById('first_name'),
                            last_name: document.getElementById('last_name'),
                            email: document.getElementById('email'),
                            submit: document.getElementById('btn-submit'),
                        };
                        form.submit.addEventListener('click', () => {
                            const request = new XMLHttpRequest();

                            request.onload = () => {
                                let responseObject = null;

                                try {
                                    responseObject = JSON.parse(request.responseText);
                                } catch (e) {
                                    console.error('Could not parse JSON!');
                                }

                                if (responseObject) {
                                    handleResponse(responseObject);
                                }
                            };

                            const requestData = `username=${form.username.value}&password=${form.password.value}`;

                            request.open('post', 'http://localhost:3000/api/users');
                            request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                            request.send(requestData);
                        });

                        function handleResponse (responseObject) {
                            if (responseObject.ok) {
                                location.href = 'dashboard.html';
                            } else {
                                while (form.messages.firstChild) {
                                    form.messages.removeChild(form.messages.firstChild);
                                }

                                responseObject.messages.forEach((message) => {
                                    const li = document.createElement('li');
                                    li.textContent = message;
                                    form.messages.appendChild(li);
                                });

                                form.messages.style.display = "block";
                            }
                        }
                    </script>

              </div>
          </div>
      </div>

  </section>


</body>
